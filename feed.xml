<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://manios.org/feed.xml" rel="self" type="application/atom+xml" /><link href="https://manios.org/" rel="alternate" type="text/html" /><updated>2023-08-30T14:45:07-05:00</updated><id>https://manios.org/feed.xml</id><title type="html">cmanios</title><subtitle>Developer life is a NullPointerException</subtitle><author><name>Christos Manios</name></author><entry><title type="html">ORA-17026: Numeric overflow when calling Oracle SQL function using Hibernate 6</title><link href="https://manios.org/2023/08/30/java-spring-hibernate-error-ora-17026-numeric-overflow-oracle-function-call" rel="alternate" type="text/html" title="ORA-17026: Numeric overflow when calling Oracle SQL function using Hibernate 6" /><published>2023-08-30T14:43:27-05:00</published><updated>2023-08-30T14:43:27-05:00</updated><id>https://manios.org/2023/08/30/java-spring-hibernate-error-ora-17026-numeric-overflow-oracle-function-call</id><content type="html" xml:base="https://manios.org/2023/08/30/java-spring-hibernate-error-ora-17026-numeric-overflow-oracle-function-call">&lt;p&gt;A few days ago we stumbled upon a very strange error while migrating a legacy application from Spring Boot 2.7.0 with Spring Data JPA (Hibernate Core 5.6.9-Final) to Spring Boot 3.1.0 (Hibernate Core 6.2.2-Final)&lt;/p&gt;

&lt;p&gt;The code was executing an Oracle database function, called &lt;code class=&quot;highlighter-rouge&quot;&gt;pl_functions.persist_bonus_points&lt;/code&gt; which was persisting some loyalty customer points for a bank and returned a transaction ID. The function call used to work before the upgrade. After upgrading to Hibernate 6 it started failing with an error:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Could not extract column [1] from JDBC ResultSet [ORA-17026: Numeric overflow] [n/a] with root cause
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After quite some investigation, we found out that when &lt;code class=&quot;highlighter-rouge&quot;&gt;pl_functions.persist_bonus_points()&lt;/code&gt; function is called, it returns a value which looks like this: &lt;code class=&quot;highlighter-rouge&quot;&gt;4807214298310656894&lt;/code&gt;. Hibernate 6 is trying to convert it to number and it fails with an overflow. In our case we could not rewrite the code because we could not understand exactly what it was doing. After searching in the web, we found in StackOverflow &lt;a href=&quot;https://stackoverflow.com/questions/36073450/calling-a-pl-sql-function-with-object-parameter-in-java&quot;&gt;question #36073450&lt;/a&gt; that the least intrusive way to patch the existing code was by using &lt;code class=&quot;highlighter-rouge&quot;&gt;.addScalar()&lt;/code&gt; method and convert the returned value to &lt;code class=&quot;highlighter-rouge&quot;&gt;String&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;After the fix the code is the following:&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getTransactionIdForUpdatingBonusPoints&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Long&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;branchId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customerId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Query&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entityManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;createNativeQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;select pl_functions.persist_bonus_points (:branchId, :customerId, :points) from dual&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;branchId&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;branchId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;customerId&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;customerId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setParameter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;points&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;points&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// FIX FOR HIBERNATE 6&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;unwrap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;NativeQuery&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;addScalar&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;transactionId&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StandardBasicTypes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;STRING&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// THIS IS WHERE THE ERROR OCCURED&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getResultList&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;getTransactionIdFromResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I hope that this helps in your Hibernate migration endeavours! Cheers from Thessaloniki, Greece!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Java" /><category term="Hibernate" /><category term="Oracle" /><category term="Database" /><category term="Spring" /><category term="Spring Boot" /><category term="java" /><category term="hibernate" /><category term="oracle" /><category term="database" /><category term="function" /><category term="overflow" /><category term="error" /><category term="spring" /><category term="spring-boot" /><summary type="html">A few days ago we stumbled upon a very strange error while migrating a legacy application from Spring Boot 2.7.0 with Spring Data JPA (Hibernate Core 5.6.9-Final) to Spring Boot 3.1.0 (Hibernate Core 6.2.2-Final)</summary></entry><entry><title type="html">Kubernetes tail Spring Boot json logs in plain text Log4j (Logback) format using Stern</title><link href="https://manios.org/2023/06/18/kubernetes-view-pod-json-log-in-plain-text-with-stern-template" rel="alternate" type="text/html" title="Kubernetes tail Spring Boot json logs in plain text Log4j (Logback) format using Stern" /><published>2023-06-18T08:50:00-05:00</published><updated>2023-06-18T08:50:00-05:00</updated><id>https://manios.org/2023/06/18/kubernetes-view-pod-json-log-in-plain-text-with-stern-template</id><content type="html" xml:base="https://manios.org/2023/06/18/kubernetes-view-pod-json-log-in-plain-text-with-stern-template">&lt;p&gt;A few days ago we were debugging a Java Spring Boot web application (called &lt;code class=&quot;highlighter-rouge&quot;&gt;engine-export-service&lt;/code&gt;) in Kubernetes and we wanted to tail the Pod logs. Since we have a lot of replicas for the &lt;code class=&quot;highlighter-rouge&quot;&gt;engine-export-service&lt;/code&gt; &lt;a href=&quot;https://kubernetes.io/docs/concepts/workloads/controllers/deployment/&quot;&gt;Deployment&lt;/a&gt; of this application, we decided to use &lt;a href=&quot;https://github.com/stern/stern&quot;&gt;Stern&lt;/a&gt;, The Multi pod and container log tailing for Kubernetes!&lt;/p&gt;

&lt;p&gt;Therefore we set up &lt;code class=&quot;highlighter-rouge&quot;&gt;stern&lt;/code&gt;, opened up a shell and run:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stern &lt;span class=&quot;nt&quot;&gt;--context&lt;/span&gt; ctx-jetengine-factory &lt;span class=&quot;nt&quot;&gt;--namespace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;jetengine-factory-prod engine-export&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output we got was looking like the following:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+ engine-export-service-7f6c797f5b-q7cm8 › engine-export
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:23.240Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Started sending of 1000 messages&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.rabbit.RabbitService&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:25.710Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Finished sending of 1000 messages&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.rabbit.RabbitService&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:26.990Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Finished retrieving engine information chunk 51/51 for 2023-06-18 after 9 minute/s and 26 seconds&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.EngineExportService&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:27.088Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Loaded 1000 normal prices in 0 seconds&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.engine.dao.EngineRepositoryImpl&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:27.139Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Loaded 0 special prices in 0 seconds&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.engine.dao.EngineRepositoryImpl&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:27.225Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Started sending of 1000 messages&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.rabbit.RabbitService&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:29.645Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Finished sending of 1000 messages&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.rabbit.RabbitService&quot;,&quot;thread_name&quot;:&quot;ForkJoinPool.commonPool-worker-3&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:29.645Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Finished export for 2023-06-18 after 9 minute/s and 29 seconds&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.EngineExportService&quot;,&quot;thread_name&quot;:&quot;scheduling-1&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:29.645Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Engine export successfully finished for date period: [2023-06-15,2023-06-18] after: 9.494 min&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.EngineExportService&quot;,&quot;thread_name&quot;:&quot;scheduling-1&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
engine-export-service-7f6c797f5b-q7cm8 engine-export {&quot;@timestamp&quot;:&quot;2023-06-15T02:09:29.664Z&quot;,&quot;@version&quot;:&quot;1&quot;,&quot;message&quot;:&quot;Open links after closing: 0&quot;,&quot;logger_name&quot;:&quot;org.manios.airplanefactory.engineexport.database.OracleLinkService&quot;,&quot;thread_name&quot;:&quot;scheduling-1&quot;,&quot;level&quot;:&quot;INFO&quot;,&quot;level_value&quot;:20000}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is quite normal, since we have configured Logback in Spring to print the logs in JSON format which is easily parsed by FluentD in order to push the logs to Elasticsearch and view them in Kibana. However, although JSON is nice and machine readable, the parsing and propagation of logs to Elasticsearch can take some time. Therefire we wanted to view the logs quickly and in a human friendly way!&lt;/p&gt;

&lt;p&gt;Fortunately, &lt;a href=&quot;https://github.com/stern/stern&quot;&gt;Stern&lt;/a&gt; allows to format the logs using a &lt;a href=&quot;https://pkg.go.dev/text/template&quot;&gt;Golang text template&lt;/a&gt;! We opened up an editor and created one! This is it (&lt;code class=&quot;highlighter-rouge&quot;&gt;stern-spring-template.tpl&lt;/code&gt;):&lt;/p&gt;

&lt;script src=&quot;https://gist.github.com/manios/cbe52788142bfa19b345b9bddbde4cca.js&quot;&gt;&lt;/script&gt;

&lt;p&gt;We saved the template into a file, called &lt;code class=&quot;highlighter-rouge&quot;&gt;stern-spring-template.tpl&lt;/code&gt; and we run again the command with the addition of the &lt;code class=&quot;highlighter-rouge&quot;&gt;--template-file&lt;/code&gt; parameter!&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;stern &lt;span class=&quot;nt&quot;&gt;--context&lt;/span&gt; ctx-jetengine-factory &lt;span class=&quot;nt&quot;&gt;--namespace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;jetengine-factory-prod &lt;span class=&quot;nt&quot;&gt;--template-file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;~/stern-spring-template.tpl&quot;&lt;/span&gt; engine-export&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now the output looks like (almost) the same as the normal we get when we develop the Spring Boot application in our IDE!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+ engine-export-service-7f6c797f5b-q7cm8 › engine-export
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:23.240Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.rabbit.RabbitService        : Started sending of 1000 messages
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:25.710Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.rabbit.RabbitService        : Finished sending of 1000 messages
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:26.990Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.EngineExportService         : Finished retrieving engine information chunk 51/51 for 2023-06-18 after 9 minute/s and 26 seconds
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:27.088Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.engine.dao.EngineRepository : Loaded 1000 normal prices in 0 seconds
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:27.139Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.engine.dao.EngineRepository : Loaded 0 special prices in 0 seconds
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:27.225Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.rabbit.RabbitService        : Started sending of 1000 messages
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:29.645Z 20000 INFO --- [ForkJoinPool.co] org.manios.airplanefactory.engineexport.rabbit.RabbitService        : Finished sending of 1000 messages
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:29.645Z 20000 INFO --- [   scheduling-1] org.manios.airplanefactory.engineexport.EngineExportService         : Finished export for 2023-06-18 after 9 minute/s and 29 seconds
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:29.645Z 20000 INFO --- [   scheduling-1] org.manios.airplanefactory.engineexport.EngineExportService         : Engine export successfully finished for date period: [2023-06-15,2023-06-18] after: 9.494 min
engine-export-service-7f6c797f5b-q7cm8 2023-06-15T02:09:29.664Z 20000 INFO --- [   scheduling-1] org.manios.airplanefactory.engineexport.database.OracleLinkService  : Open links after closing: 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I hope this helped you a little bit with your next Kubernetes endeavour!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Kubernetes" /><category term="Spring" /><category term="Spring Boot" /><category term="kubernetes" /><category term="spring" /><category term="boot" /><category term="pod" /><category term="log" /><category term="tail" /><category term="stern" /><summary type="html">A few days ago we were debugging a Java Spring Boot web application (called engine-export-service) in Kubernetes and we wanted to tail the Pod logs. Since we have a lot of replicas for the engine-export-service Deployment of this application, we decided to use Stern, The Multi pod and container log tailing for Kubernetes!</summary></entry><entry><title type="html">MS SQL Server Docker container restore database from .bak file created in Windows to a New Location</title><link href="https://manios.org/2022/12/23/oracle-sql-select-date-range-between-range" rel="alternate" type="text/html" title="MS SQL Server Docker container restore database from .bak file created in Windows to a New Location" /><published>2022-12-23T12:00:00-06:00</published><updated>2022-12-23T12:00:00-06:00</updated><id>https://manios.org/2022/12/23/oracle-sql-select-date-range-between-range</id><content type="html" xml:base="https://manios.org/2022/12/23/oracle-sql-select-date-range-between-range">&lt;p&gt;Yesterday, a client which uses Microsoft SQL Server 2008 R2 (SP2) wanted to test if his database backup can work in Microsoft SQL Server 2019 Developer version. He currently runs his SQL Server instance in Windows Server. He provided us with a &lt;code class=&quot;highlighter-rouge&quot;&gt;.bak&lt;/code&gt; file, let us call it for this post &lt;code class=&quot;highlighter-rouge&quot;&gt;WinCarFactorySQL.bak&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;run-a-microsoft-sql-server-docker-container&quot;&gt;Run a Microsoft SQL Server Docker container&lt;/h2&gt;

&lt;p&gt;In order to test quickly, we are going to use the official, Ubuntu based, &lt;a href=&quot;https://hub.docker.com/_/microsoft-mssql-server&quot;&gt;Microsoft SQL Server 2019 docker container&lt;/a&gt;. Therefore we download it:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker pull mcr.microsoft.com/mssql/server:2019-CU18-ubuntu-20.04
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and run it in &lt;code class=&quot;highlighter-rouge&quot;&gt;Developer&lt;/code&gt; mode:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; sqlserver2019 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ACCEPT_EULA=Y&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'MSSQL_SA_PASSWORD=mysuperduperpassworD1234!56'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;MSSQL_PID=Developer&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1433:1433 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/home/mylinux/wincarfactorybak:/opt/wincarfactorybak&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    mcr.microsoft.com/mssql/server:2019-CU18-ubuntu-20.04
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see we mount &lt;code class=&quot;highlighter-rouge&quot;&gt;/home/mylinux/wincarfactorybak&lt;/code&gt; directory which contains the &lt;code class=&quot;highlighter-rouge&quot;&gt;WinCarFactorySQL.bak&lt;/code&gt; in order to use it inside the container in &lt;code class=&quot;highlighter-rouge&quot;&gt;/opt/wincarfactorybak&lt;/code&gt; directory.&lt;/p&gt;

&lt;p&gt;For more information you can read: &lt;a href=&quot;https://learn.microsoft.com/en-us/sql/linux/quickstart-install-connect-docker?view=sql-server-ver16&amp;amp;pivots=cs1-bash&quot;&gt;Quickstart: Run SQL Server Linux container images with Docker&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;examine-bak-file-contents&quot;&gt;Examine .bak file contents&lt;/h2&gt;

&lt;p&gt;In order to restore the database properly, we have to examine the &lt;code class=&quot;highlighter-rouge&quot;&gt;.bak&lt;/code&gt; file contents. This can be achieved by executing this command on the running container:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; sqlserver2019 /opt/mssql-tools/bin/sqlcmd &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; localhost &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; SA &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mysuperduperpassworD1234!56'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   &lt;span class=&quot;nt&quot;&gt;-Q&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'RESTORE FILELISTONLY FROM DISK = &quot;/opt/wincarfactorybak/WinCarFactorySQL.bak&quot;'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
   | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;cut&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 1-2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output looks like this:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;LogicalName       PhysicalName
-----------       ------------
WinCarFactorySQL       c:\Program Files\Microsoft SQL Server\MSSQL10_50.SQLEXPRESS\MSSQL\DATA\WinCarFactorySQL.mdf
WinCarFactorySQL_log   c:\Program Files\Microsoft SQL Server\MSSQL10_50.SQLEXPRESS\MSSQL\DATA\WinCarFactorySQL_log.ldf

(2 rows)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more information you can read: &lt;a href=&quot;https://learn.microsoft.com/en-us/sql/linux/tutorial-restore-backup-in-sql-server-container?view=sql-server-ver16&quot;&gt;Restore a SQL Server database in a Linux Docker container&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;restore-database&quot;&gt;Restore database&lt;/h2&gt;

&lt;p&gt;Now we have to import and relocate these two files into the directory SQL Server uses to store these files in this container. The docker container uses a non-root user called &lt;code class=&quot;highlighter-rouge&quot;&gt;mssql&lt;/code&gt;. Therefore in order to find the directory we searched for &lt;code class=&quot;highlighter-rouge&quot;&gt;*.mdf&lt;/code&gt; files:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bob@bobis:/home/mylinux&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt;  sqlserver2019 /bin/bash
mssql@7b208ca8f759:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;f^C
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;failed reverse-i-search&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;fin&lt;span class=&quot;s1&quot;&gt;': ^C
mssql@7b208ca8f759:/$ find -iname &quot;*.mdf&quot;
./var/opt/mssql/data/tempdb.mdf
./var/opt/mssql/data/msdbdata.mdf
./var/opt/mssql/data/model_replicatedmaster.mdf
./var/opt/mssql/data/model_msdbdata.mdf
./var/opt/mssql/data/model.mdf
./var/opt/mssql/data/master.mdf
mssql@7b208ca8f759:/$ whoami
mssql
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally we restore the &lt;code class=&quot;highlighter-rouge&quot;&gt;WinCarFactorySQL.bak&lt;/code&gt; file using the following command:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; sqlserver2019 /opt/mssql-tools/bin/sqlcmd &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; localhost &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; SA &lt;span class=&quot;nt&quot;&gt;-P&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mysuperduperpassworD1234!56'&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;-Q&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'RESTORE DATABASE WinCarFactorySQL FROM DISK = &quot;/opt/wincarfactorybak/WinCarFactorySQL.bak&quot; WITH MOVE &quot;WinCarFactorySQL&quot; TO &quot;/var/opt/mssql/data/WinCarFactorySQL.mdf&quot;, MOVE &quot;WinCarFactorySQL_log&quot; TO &quot;/var/opt/mssql/data/WinCarFactorySQL_log.ldf&quot;'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you get an output similar to the following, then your database restoration was successful!&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Processed 130576 pages for database 'WinCarFactorySQL', file 'WinCarFactorySQL' on file 1.
Processed 1 pages for database 'WinCarFactorySQL', file 'WinCarFactorySQL_log' on file 1.
Converting database 'WinCarFactorySQL' from version 661 to the current version 904.
Database 'WinCarFactorySQL' running the upgrade step from version 661 to version 668.
Database 'WinCarFactorySQL' running the upgrade step from version 668 to version 669.
-- some lines truncated --
Database 'WinCarFactorySQL' running the upgrade step from version 901 to version 902.
Database 'WinCarFactorySQL' running the upgrade step from version 902 to version 903.
Database 'WinCarFactorySQL' running the upgrade step from version 903 to version 904.
RESTORE DATABASE successfully processed 130577 pages in 10.623 seconds (96.030 MB/sec).
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more information about these commands, you can read:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://learn.microsoft.com/en-us/sql/relational-databases/backup-restore/restore-files-to-a-new-location-sql-server?view=sql-server-ver16&quot;&gt;Restore Files to a New Location (SQL Server)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.sqlshack.com/change-default-database-file-and-backup-paths-in-sql-server-on-linux/&quot;&gt;Change default database file and backup paths in SQL Server on Linux&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;note-regarding-directory-permissions&quot;&gt;Note regarding directory permissions&lt;/h3&gt;

&lt;p&gt;If you decide to use another directory to &lt;code class=&quot;highlighter-rouge&quot;&gt;MOVE&lt;/code&gt; your &lt;code class=&quot;highlighter-rouge&quot;&gt;.mdf&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;.ldf&lt;/code&gt; files into any other random directory, you might stumble uppon permission issues. For instance if instead of using &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/opt/mssql/data&lt;/code&gt; you use &lt;code class=&quot;highlighter-rouge&quot;&gt;/opt/wincarfactorybak&lt;/code&gt; which is not writable by &lt;code class=&quot;highlighter-rouge&quot;&gt;mssql&lt;/code&gt; user you might get errors like this:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;The operating system returned the error '5(Access is denied.)' while attempting 'RestoreContainer::ValidateTargetForCreation' on '/opt/wincarfactorybak/WinCarFactorySQL.mdf'.
Msg 3156, Level 16, State 5, Server 7b208ca8f759, Line 1
File 'WinCarFactorySQL' cannot be restored to '/opt/wincarfactorybak/WinCarFactorySQL.mdf'. Use WITH MOVE to identify a valid location for the file.
Msg 3634, Level 16, State 1, Server 7b208ca8f759, Line 1
The operating system returned the error '5(Access is denied.)' while attempting 'RestoreContainer::ValidateTargetForCreation' on '/opt/wincarfactorybak/WinCarFactorySQL_log.ldf'.
Msg 3156, Level 16, State 5, Server 7b208ca8f759, Line 1
File 'WinCarFactorySQL' cannot be restored to '/opt/wincarfactorybak/WinCarFactorySQL_log.ldf'. Use WITH MOVE to identify a valid location for the file.
Msg 3119, Level 16, State 1, Server 7b208ca8f759, Line 1
Problems were identified while planning for the RESTORE statement. Previous messages provide details.
Msg 3013, Level 16, State 1, Server 7b208ca8f759, Line 1
RESTORE DATABASE is terminating abnormally.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>cmanios</name></author><category term="MS SQL Server" /><category term="MS SQL" /><category term="Databases" /><category term="SQL" /><category term="mssql" /><category term="sql" /><category term="sqlserver" /><category term="query" /><category term="database" /><category term="restore" /><category term="bak" /><category term="docker" /><category term="container" /><summary type="html">Yesterday, a client which uses Microsoft SQL Server 2008 R2 (SP2) wanted to test if his database backup can work in Microsoft SQL Server 2019 Developer version. He currently runs his SQL Server instance in Windows Server. He provided us with a .bak file, let us call it for this post WinCarFactorySQL.bak.</summary></entry><entry><title type="html">SQL query to check if a date range is between two dates in Oracle database</title><link href="https://manios.org/2022/07/22/oracle-sql-select-date-range-between-range" rel="alternate" type="text/html" title="SQL query to check if a date range is between two dates in Oracle database" /><published>2022-07-22T13:55:00-05:00</published><updated>2022-07-22T13:55:00-05:00</updated><id>https://manios.org/2022/07/22/oracle-sql-select-date-range-between-range</id><content type="html" xml:base="https://manios.org/2022/07/22/oracle-sql-select-date-range-between-range">&lt;p&gt;A few days ago, we had to select records from an &lt;a href=&quot;https://en.wikipedia.org/wiki/Oracle_Database&quot;&gt;Oracle database&lt;/a&gt; table which should be inside a given date range. The difficult thing with those records was that they had a date range defined in them too.&lt;/p&gt;

&lt;p&gt;The table was described as:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;TABLE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;	
    &lt;span class=&quot;nv&quot;&gt;&quot;ID&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NUMBER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;nv&quot;&gt;&quot;FROMDATE&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;DATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;nv&quot;&gt;&quot;TODATE&quot;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;DATE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ENABLE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;CONSTRAINT&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB_PK&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;&quot;ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the records like:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ID&lt;/th&gt;
      &lt;th&gt;FROMDATE&lt;/th&gt;
      &lt;th&gt;TODATE&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;10-JUL-2022&lt;/td&gt;
      &lt;td&gt;10-JUL-2040&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;10-JUL-2024&lt;/td&gt;
      &lt;td&gt;10-JUL-2040&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;22-JUL-2022&lt;/td&gt;
      &lt;td&gt;23-JUL-2022&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;24-JUL-2022&lt;/td&gt;
      &lt;td&gt;25-JUL-2022&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;22-JUL-2022&lt;/td&gt;
      &lt;td&gt;22-JUL-2022&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;or in &lt;code class=&quot;highlighter-rouge&quot;&gt;SQL insert&lt;/code&gt; statements:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FROMDATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TODATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-10'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2040-07-10'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FROMDATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TODATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2024-07-10'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2040-07-10'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FROMDATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TODATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'3'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-22'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-23'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FROMDATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TODATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'4'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-24'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-25'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;&quot;DATEBOB&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FROMDATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TODATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'5'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-22'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-22'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In order to select the records which are valid from the current date up to 3 days in the future, you can do it with this query:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datebob&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trunc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sysdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BETWEEN&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromdate&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AND&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;todate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trunc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sysdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BETWEEN&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromdate&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AND&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;todate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;example output when current date is &lt;code class=&quot;highlighter-rouge&quot;&gt;2022-07-22&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  ID FROMDATE  TODATE   
---- --------- ---------
   1 10-JUL-22 10-JUL-40
   3 22-JUL-22 23-JUL-22
   4 24-JUL-22 25-JUL-22
   5 22-JUL-22 22-JUL-22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In order to select the records which are valid from a specific date current date (let us say &lt;code class=&quot;highlighter-rouge&quot;&gt;2022-07-24&lt;/code&gt;) up to 3 days in the future, you can do it with this query:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datebob&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; 
&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-24'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BETWEEN&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromdate&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AND&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;todate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TO_DATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'2022-07-24'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'YYYY-MM-DD'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;BETWEEN&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fromdate&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;AND&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;todate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the output looks like the following:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;   ID FROMDATE  TODATE   
 ---- --------- ---------
    1 10-JUL-22 10-JUL-40
    4 24-JUL-22 25-JUL-22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that in order to add days in a &lt;a href=&quot;https://docs.oracle.com/cd/B19306_01/server.102/b14225/ch4datetime.htm#sthref395&quot;&gt;DATE&lt;/a&gt; column, you just need to use the plus sign and the number of days to add. There is no specific function like &lt;a href=&quot;https://mariadb.com/kb/en/date_add/&quot;&gt;DATE_ADD&lt;/a&gt; of MariaDB which offers different intervals, like seconds, months, etc.&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Oracle" /><category term="Databases" /><category term="SQL" /><category term="oracle" /><category term="sql" /><category term="query" /><category term="database" /><category term="date" /><category term="range" /><summary type="html">A few days ago, we had to select records from an Oracle database table which should be inside a given date range. The difficult thing with those records was that they had a date range defined in them too.</summary></entry><entry><title type="html">Go Mongodb Error Cannot create field X in element {Y: null}</title><link href="https://manios.org/2021/08/04/go-mongodb-error-cannot-create-field-in-element-null" rel="alternate" type="text/html" title="Go Mongodb Error Cannot create field X in element {Y: null}" /><published>2021-08-04T13:55:00-05:00</published><updated>2021-08-04T13:55:00-05:00</updated><id>https://manios.org/2021/08/04/go-mongodb-error-cannot-create-field-in-element-null</id><content type="html" xml:base="https://manios.org/2021/08/04/go-mongodb-error-cannot-create-field-in-element-null">&lt;p&gt;Today we had a MongoDB 3.6 collection with the following documents:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;insertMany&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Odyseas&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Androutsos&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Theodoros&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Kolokotronis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Makrygiannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Kapodistrias&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Emanouil&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;surname&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Pappas&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and we wanted to update them with Go using &lt;a href=&quot;https://github.com/mongodb/mongo-go-driver&quot;&gt;mongodb/mongo-go-driver&lt;/a&gt; in order to become like this:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Ioannis&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;surname&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Kapodistrias&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;profilePicture&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;iconUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;retrievalStatus&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NOT_FOUND&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lastSuccessfulRetrieval&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ISODate(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2021-07-13T10:00:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Ioannis&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;surname&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Makrygiannis&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;profilePicture&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;iconUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;retrievalStatus&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NOT_FOUND&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lastSuccessfulRetrieval&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ISODate(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2021-07-13T10:00:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;. We were using the following update statement:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$set&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.iconUrl&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.retrievalStatus&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.lastSuccessfulRetrieval&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;ISODate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2021-07-13T10:00:00.000Z&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;multi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;however the MongoDB driver was returning this error:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Cannot create field 'image' in element {profilePicture: null}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Initially we thought that something is wrong with the single &lt;code class=&quot;highlighter-rouge&quot;&gt;update()&lt;/code&gt; command and we tried in mongo shell the &lt;code class=&quot;highlighter-rouge&quot;&gt;updateMany()&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;updateMany&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$set&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.iconUrl&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.retrievalStatus&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.lastSuccessfulRetrieval&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;ISODate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2021-07-13T10:00:00.000Z&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However it returned a quite similar error:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
Failed to execute script.

Error:
WriteError({
	&quot;index&quot; : 0,
	&quot;code&quot; : 28,
	&quot;errmsg&quot; : &quot;Cannot create field 'image' in element {profilePicture: null}&quot;,
	&quot;op&quot; : {
		&quot;q&quot; : {
			&quot;surname&quot; : &quot;Manios&quot;
		},
		&quot;u&quot; : {
			&quot;$set&quot; : {
				&quot;profilePicture.image.iconUrl&quot; : null,
				&quot;profilePicture.image.retrievalStatus&quot; : &quot;NOT_FOUND&quot;,
				&quot;profilePicture.image.lastSuccessfulRetrieval&quot; : ISODate(&quot;2021-07-13T10:00:00Z&quot;)
			}
		},
		&quot;multi&quot; : true,
		&quot;upsert&quot; : false
	}
}) :
WriteError({
	&quot;index&quot; : 0,
	&quot;code&quot; : 28,
	&quot;errmsg&quot; : &quot;Cannot create field 'image' in element {profilePicture: null}&quot;,
	&quot;op&quot; : {
		&quot;q&quot; : {
			&quot;surname&quot; : &quot;Manios&quot;
		},
		&quot;u&quot; : {
			&quot;$set&quot; : {
				&quot;profilePicture.image.iconUrl&quot; : null,
				&quot;profilePicture.image.retrievalStatus&quot; : &quot;NOT_FOUND&quot;,
				&quot;profilePicture.image.lastSuccessfulRetrieval&quot; : ISODate(&quot;2021-07-13T10:00:00Z&quot;)
			}
		},
		&quot;multi&quot; : true,
		&quot;upsert&quot; : false
	}
})
WriteError@src/mongo/shell/bulk_api.js:458:48
mergeBatchResults@src/mongo/shell/bulk_api.js:855:49
executeBatch@src/mongo/shell/bulk_api.js:919:13
Bulk/this.execute@src/mongo/shell/bulk_api.js:1163:21
DBCollection.prototype.updateMany@src/mongo/shell/crud_api.js:690:17
@(shell):1:1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We searched for the error in the internet but we could not understand where we are wrong:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.google.com/search?client=firefox-b-d&amp;amp;q=code%22+%3A+28%2C+%09%22errmsg%22+%3A+%22Cannot+create+element+in+Null%22%2C&quot;&gt;Google: code: 28, “errmsg” : “Cannot create element in Null”,&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/55670619/mongodb-cannot-create-field-x-in-element&quot;&gt;Mongodb “Cannot create field ‘x’ in element” [duplicate]&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://forum.golangbridge.org/t/null-data-type-in-mongodb/5501&quot;&gt;NULL data type in MongoDB&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;After some time and numerous attempts, we realised that MongoDB was trying to tell us that it cannot create the subdocument:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nl&quot;&gt;&quot;image&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;iconUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;retrievalStatus&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NOT_FOUND&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;lastSuccessfulRetrieval&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ISODate(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;2021-07-13T10:00:00.000Z&quot;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;inside a field which is alread assigned to &lt;code class=&quot;highlighter-rouge&quot;&gt;null&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nl&quot;&gt;&quot;profilePicture&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So with a small change, the update statement works:&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;// ------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// BEFORE&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// THIS DOES NOT WORK AND CONFUSES MONGODB. &lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$set&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.iconUrl&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.retrievalStatus&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture.image.lastSuccessfulRetrieval&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;ISODate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2021-07-13T10:00:00.000Z&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;multi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// AFTER&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ------&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// THIS WORKS&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getCollection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;person&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Ioannis&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$set&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;profilePicture&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;iconUrl&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;retrievalStatus&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;NOT_FOUND&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;lastSuccessfulRetrieval&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;nx&quot;&gt;ISODate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2021-07-13T10:00:00.000Z&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;multi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We tested the example in the following versions (running &lt;code class=&quot;highlighter-rouge&quot;&gt;db.version()&lt;/code&gt; in Mongo shell):&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;CosmosDB for MongoDB 3.6.0&lt;/li&gt;
  &lt;li&gt;MongoDB 3.6.22&lt;/li&gt;
  &lt;li&gt;MongoDB 4.4.0&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;and all behave identically.&lt;/p&gt;

&lt;p&gt;We hope this helped you and you gain some minutes instead of searching in the web to find a solution! Greetings from our hot Greece with 40 °C!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Go" /><category term="Golang" /><category term="MongoDB" /><category term="go" /><category term="golang" /><category term="mongodb" /><category term="driver" /><category term="database" /><category term="error" /><category term="dot" /><category term="field" /><category term="nested" /><summary type="html">Today we had a MongoDB 3.6 collection with the following documents:</summary></entry><entry><title type="html">Convert from/to JSON decimal fields in Go (golang) structs</title><link href="https://manios.org/2021/07/24/golang-decimal-field-in-struct-json-convert" rel="alternate" type="text/html" title="Convert from/to JSON decimal fields in Go (golang) structs" /><published>2021-07-24T11:27:00-05:00</published><updated>2021-07-24T11:27:00-05:00</updated><id>https://manios.org/2021/07/24/golang-decimal-field-in-struct-json-convert</id><content type="html" xml:base="https://manios.org/2021/07/24/golang-decimal-field-in-struct-json-convert">&lt;p&gt;Yesterday we had to marshal and umarshal to/from JSON some HTTP requests and responses in a &lt;a href=&quot;https://golang.org/&quot;&gt;Go&lt;/a&gt; microservice we are building. We already use &lt;a href=&quot;https://github.com/ericlagergren/decimal&quot;&gt;ericlagergren/decimal&lt;/a&gt;. However we have spotted that the &lt;code class=&quot;highlighter-rouge&quot;&gt;struct&lt;/code&gt; for the response were declared like this:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncomeExpensesResponse&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Income&lt;/span&gt;   &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`json:&quot;income&quot;`&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Expenses&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`json:&quot;expenses&quot;`&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and inside the source code, my colleagues were trying to manually convert from/to string to &lt;code class=&quot;highlighter-rouge&quot;&gt;*decimal.Big&lt;/code&gt; for responses like:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;income&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;14.67&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;expenses&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;340.75&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is actually not needed! Why should we reinvent the wheel?&lt;/p&gt;

&lt;p&gt;Hence I created a small test to demonstrate &lt;a href=&quot;https://github.com/ericlagergren/decimal&quot;&gt;ericlagergren/decimal&lt;/a&gt; JSON marshalling and unmarshalling capabilities:&lt;/p&gt;

&lt;div class=&quot;language-go highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
	&lt;span class=&quot;s&quot;&gt;&quot;encoding/json&quot;&lt;/span&gt;
	&lt;span class=&quot;s&quot;&gt;&quot;testing&quot;&lt;/span&gt;

	&lt;span class=&quot;s&quot;&gt;&quot;github.com/ericlagergren/decimal&quot;&lt;/span&gt;
	&lt;span class=&quot;s&quot;&gt;&quot;github.com/stretchr/testify/assert&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncomeExpenses&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Income&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Big&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`json:&quot;income&quot;`&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;Expenses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Big&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`json:&quot;expenses&quot;`&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TestMarshalIncomeExpensesToJson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;pentochiliaro&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1467&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;drachmaEuro&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;34075&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;testExpense&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncomeExpenses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;Income&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;pentochiliaro&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;Expenses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drachmaEuro&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;expectedJson&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`{&quot;income&quot;: &quot;14.67&quot;, &quot;expenses&quot;: &quot;340.75&quot;}`&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;jsonStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Marshal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testExpense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;JSONEq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expectedJson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;jsonStr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TestUnMarshalIncomeExpensesFromJson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;pentochiliaro&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1467&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;drachmaEuro&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decimal&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;34075&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;expectedExpense&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncomeExpenses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;Income&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;n&quot;&gt;pentochiliaro&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;Expenses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drachmaEuro&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;inputJson&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;`{&quot;income&quot;: &quot;14.67&quot;, &quot;expenses&quot;: &quot;340.75&quot;}`&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;incomeExpences&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncomeExpenses&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Unmarshal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([]&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputJson&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;incomeExpences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;assert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expectedExpense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;incomeExpences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you are puzzled by the words &lt;code class=&quot;highlighter-rouge&quot;&gt;pentochiliaro&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;drachmaEuro&lt;/code&gt;, let me explain!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Pentochiliaro&lt;/strong&gt; (πεντοχίλιαρο) is a complex word consisting of the words &lt;strong&gt;Pente&lt;/strong&gt; (Πέντε), which means &lt;strong&gt;five&lt;/strong&gt; in Greek and &lt;strong&gt;Chiliades&lt;/strong&gt; (Χιλιάδες) which means &lt;strong&gt;thousands&lt;/strong&gt; in Greek. This how it the &lt;a href=&quot;https://en.wikipedia.org/wiki/Greek_drachma#Banknotes&quot;&gt;5000 drachma banknote&lt;/a&gt; was called before Euro currency came!&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;drachmaEuro&lt;/strong&gt;: This is the currency exchange rate while we used both Drachmas and Euros in Greece. 1 Euro was 340.75 Greek &lt;a href=&quot;https://en.wikipedia.org/wiki/Greek_drachma&quot;&gt;Drachmas&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I hope this helps! Have a nice evening from sunny Greece!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Go" /><category term="Golang" /><category term="JSON" /><category term="go" /><category term="golang" /><category term="struct" /><category term="json" /><category term="field" /><category term="decimal" /><category term="number" /><category term="floating" /><category term="point" /><category term="marshal" /><category term="unmarshal" /><summary type="html">Yesterday we had to marshal and umarshal to/from JSON some HTTP requests and responses in a Go microservice we are building. We already use ericlagergren/decimal. However we have spotted that the struct for the response were declared like this:</summary></entry><entry><title type="html">PostgreSQL case and accent insentitive SQL queries</title><link href="https://manios.org/2021/02/17/postgresql-case-accent-insentitive-sql-queries" rel="alternate" type="text/html" title="PostgreSQL case and accent insentitive SQL queries" /><published>2021-02-17T13:00:00-06:00</published><updated>2021-02-17T13:00:00-06:00</updated><id>https://manios.org/2021/02/17/postgresql-case--accent-insentitive-sql-queries</id><content type="html" xml:base="https://manios.org/2021/02/17/postgresql-case-accent-insentitive-sql-queries">&lt;p&gt;A few days ago we were implementing a Spring Boot application which stored its data into a PostgreSQL database. As a requirement we needed to search into the database with &lt;a href=&quot;https://www.w3schools.com/sql/sql_like.asp&quot;&gt;LIKE&lt;/a&gt; operator in our &lt;code class=&quot;highlighter-rouge&quot;&gt;SQL&lt;/code&gt; queries and at the same time perform case and accent insensitive searches. Since we are Greek, this is pretty typical for us because our letters have diacritics (“tonos”). So a query like the following&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blablatable&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%χρη%'&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should return results for:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Χρή&lt;/strong&gt;στος&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ΧΡΗΣ&lt;/strong&gt;ΤΟΣ&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;χΡή&lt;/strong&gt;στος&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The aforementioned SQL query works perfectly normal in a MySQL or MariaDB database with collation &lt;code class=&quot;highlighter-rouge&quot;&gt;utf8_general_ci&lt;/code&gt;. However in PostgreSQL this is not the case. So after some searching and reading StackOverflow &lt;a href=&quot;https://stackoverflow.com/questions/11005036/does-postgresql-support-accent-insensitive-collations&quot;&gt;#11005036&lt;/a&gt;, we figured out how to make case and accent insensitive search SQL queries.&lt;/p&gt;

&lt;h2 id=&quot;fire-up-a-postgresql-docker-container&quot;&gt;Fire up a PostgreSQL Docker container&lt;/h2&gt;

&lt;p&gt;We chose to use PostgreSQL inside a Docker container, so we fire up one:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; postgres &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 5432:5432 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;POSTGRES_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;strongpassword &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;POSTGRES_USER&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;stronguser &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;POSTGRES_DB&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;airplanes &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; postgres:13.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;connect-to-postgresql-using-a-docker-container&quot;&gt;Connect to PostgreSQL using a Docker container&lt;/h2&gt;

&lt;p&gt;We used a temporary container to connect to our newly created database. You can skip this step and use another client such as &lt;a href=&quot;https://www.pgadmin.org/&quot;&gt;pgAdmin&lt;/a&gt; or &lt;a href=&quot;https://dbeaver.io/&quot;&gt;DBeaver&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;docker run &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; postgres:13.0 psql &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; host.docker.internal &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; airplanes &lt;span class=&quot;nt&quot;&gt;--user&lt;/span&gt; stronguser
Password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user stronguser:
&amp;lt;enter thy password&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Mind the &lt;code class=&quot;highlighter-rouge&quot;&gt;host.docker.internal&lt;/code&gt;. This host name is used &lt;u&gt;only in Docker for Windows&lt;/u&gt; to mark the host computer where Docker runs.&lt;/p&gt;

&lt;h2 id=&quot;create-an-extension-in-postgresql&quot;&gt;Create an extension in PostgreSQL&lt;/h2&gt;

&lt;p&gt;In order to use case and accent insensitive search SQL queries, we need to use a PostgreSQL extension. So, execute in your favourite PostgreSQL client:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EXTENSION&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unaccent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;create-a-table-and-insert-some-data&quot;&gt;Create a table and insert some data&lt;/h2&gt;

&lt;p&gt;Then we need to create a simple table in the default schema &lt;code class=&quot;highlighter-rouge&quot;&gt;public&lt;/code&gt;, which will have some text data with accents:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BOBOS_SEQUENCE&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;increment&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;table&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;int8&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;DEFAULT&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;nextval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'BOBOS_SEQUENCE'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;varchar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;primary&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After that we populate it with some test data:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Τάκης, the best handmade gyros of Triandria'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Χρήστος'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ΧΡΗΣΤΟΣ'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;VALUES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'χΡήστος'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;sql-case-and-accent-insensitive-queries&quot;&gt;SQL case and accent insensitive queries&lt;/h2&gt;

&lt;p&gt;Finally in order to perform case and accent insensitive SQL queries , execute the following statement:&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;public&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bobos&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unaccent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;LOWER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NAME&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;like&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unaccent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;LOWER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'%χρη%'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The results will be like the following:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;id|name   |
--|-------|
 2|Χρήστος|
 3|ΧΡΗΣΤΟΣ|
 4|χΡήστος|
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you might have noticed, we need to use both &lt;code class=&quot;highlighter-rouge&quot;&gt;unaccent()&lt;/code&gt; extension and &lt;code class=&quot;highlighter-rouge&quot;&gt;LOWER()&lt;/code&gt; function in order to meet the desired result.&lt;/p&gt;

&lt;p&gt;I hope you found this article useful and you do not waste any more time searching in the web. Have a nice day and love thy neighbour!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Postgres" /><category term="Database" /><category term="SQL" /><category term="postgres" /><category term="postgresql" /><category term="database" /><category term="case" /><category term="accent" /><category term="insensitive" /><category term="query" /><category term="sql" /><category term="like" /><category term="statement" /><category term="search" /><category term="docker" /><summary type="html">A few days ago we were implementing a Spring Boot application which stored its data into a PostgreSQL database. As a requirement we needed to search into the database with LIKE operator in our SQL queries and at the same time perform case and accent insensitive searches. Since we are Greek, this is pretty typical for us because our letters have diacritics (“tonos”). So a query like the following</summary></entry><entry><title type="html">Lenovo Thinkpad T470p camera problem switching on and off in Windows 10</title><link href="https://manios.org/2020/01/12/lenovo-thinkpad-t470p-camera-problem-windows-10" rel="alternate" type="text/html" title="Lenovo Thinkpad T470p camera problem switching on and off in Windows 10" /><published>2020-01-12T04:19:00-06:00</published><updated>2020-09-13T05:44:00-05:00</updated><id>https://manios.org/2020/01/12/lenovo-thinkpad-t470p-camera-problem-windows-10</id><content type="html" xml:base="https://manios.org/2020/01/12/lenovo-thinkpad-t470p-camera-problem-windows-10">&lt;h2 id=&quot;issues&quot;&gt;Issues&lt;/h2&gt;

&lt;p&gt;After Windows 10 performed its updates in our Lenovo Thinkpad T470p laptop, we could not use the camera. The symptoms were the following:  When we tried to use the laptop camera, the camera turned on (led light is green) and after 2 seconds it turned off (led light off).&lt;/p&gt;

&lt;p&gt;The laptop has Windows 10. In detail:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:\Users\sbobos&amp;gt; [System.Environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      18362  0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We had searched through the web and followed multiple steps, but the camera was still not working:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.itsupportguides.com/knowledge-base/windows-10/solved-lenovo-built-in-webcam-camera-not-working-windows-10/&quot;&gt;[SOLVED] Lenovo – Built-in webcam camera not working (Windows 10)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;https://www.techjunkie.com/lenovo-webcam-not-working-issue/&lt;/li&gt;
  &lt;li&gt;https://forums.lenovo.com/t5/ThinkPad-T400-T500-and-newer-T/T410-Webcam-turning-off-after-3-10-seconds/td-p/1184859&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.google.com/search?client=firefox-b-d&amp;amp;ei=sP2vXbbFFszIwALWrKeYDA&amp;amp;q=lenovo+camera+switches+off+automatically&amp;amp;oq=lenovo+camera+switches+off+automa&amp;amp;gs_l=psy-ab.3.0.33i22i29i30l2.16104.24085..24883...0.0..0.127.977.3j6......0....1..gws-wiz.......0i8i13i30j0i22i30.y8k_Tu2u8mM&quot;&gt;Google : lenovo camera switches off automatically&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.google.com/search?client=firefox-b-d&amp;amp;ei=N_yvXdeoOc6tkwWG8av4CA&amp;amp;q=lenovo+camera+not+working+windows+10+update&amp;amp;oq=lenovo+camera+not+working+windows+10+update&amp;amp;gs_l=psy-ab.3..33i22i29i30l2.23492.24453..24552...0.2..0.176.769.0j5......0....1..gws-wiz.......0i71j0i19j0i22i30i19.AzKXz9G1Cac&amp;amp;ved=0ahUKEwiXoLKS6bHlAhXO1qQKHYb4Co8Q4dUDCAo&amp;amp;uact=5&quot;&gt;Google: lenovo camera not working windows 10 update&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;My computer looked like as it the solutions described above:&lt;/p&gt;

&lt;p&gt;The camera permissions:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue1.png&quot;&gt;&lt;img src=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue1.png&quot; alt=&quot;Windows 10 Camera permissions&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue2.png&quot;&gt;&lt;img src=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue2.png&quot; alt=&quot;Windows 10 Camera permissions&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;The Lenovo Vantage configuration was:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue3.jpg&quot;&gt;&lt;img src=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue3.jpg&quot; alt=&quot;Windows 10 Camera Lenovo Vantage configuration&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;Camera driver properties:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue4.png&quot;&gt;&lt;img src=&quot;/images/2020-01-12-lenovo-thinkpad-camera-issue/thinkpad-camera-issue4.png&quot; alt=&quot;Windows 10 Camera Lenovo Vantage configuration&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;the-actual-problem&quot;&gt;The actual problem:&lt;/h2&gt;

&lt;p&gt;After more than 3 hours it struck us in the head: “Why don’t we have a look in Windows log?”. While inspecting it, we stumbled upon this error:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Faulting application name: svchost.exe_FrameServer, version: 10.0.18362.1, time stamp: 0x32d6c210
Faulting module name: RsProvider.dll, version: 1.30.0.0, time stamp: 0x57ee1a06
Exception code: 0xc0000005
Fault offset: 0x000000000007bd6d
Faulting process id: 0x24b4
Faulting application start time: 0x01d5a4ef579b77f9
Faulting application path: C:\WINDOWS\System32\svchost.exe
Faulting module path: C:\Program Files\Realtek\RsProviders\RsProvider.dll
Report Id: c07bcfb8-dfcc-401d-b116-72ccc3417d71
Faulting package full name: 
Faulting package-relative application ID: 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error appeared whenever we were trying to use the Camera.&lt;/p&gt;

&lt;h2 id=&quot;solution-1&quot;&gt;Solution 1&lt;/h2&gt;

&lt;p&gt;This solution is a contribution from user &lt;a href=&quot;https://disqus.com/by/lgpms2020/&quot;&gt;lgpms&lt;/a&gt; who added it as a comment to our initial post. I place it first, because it is simpler than my solution 2 and I can also confirm that it works for us. So thanks again and kudos to &lt;a href=&quot;https://disqus.com/by/lgpms2020/&quot;&gt;lgpms&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Open your File Explorer and browse to the location &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Program Files\Realtek\RsProviders&lt;/code&gt;. Rename the directory from &lt;code class=&quot;highlighter-rouge&quot;&gt;RsProviders&lt;/code&gt; to something else, like &lt;code class=&quot;highlighter-rouge&quot;&gt;RsProviders_&lt;/code&gt; (note the underscore in the end). So the directory will become:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;OLD NAME&lt;/strong&gt;: &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Program Files\Realtek\RsProviders&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;NEW NAME&lt;/strong&gt;: &lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Program Files\Realtek\RsProviders_&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It seems that for some reason the FrameServer moves on and works when it does not find the initial path.&lt;/p&gt;

&lt;h2 id=&quot;solution-2&quot;&gt;Solution 2&lt;/h2&gt;

&lt;p&gt;After searching this error at Google, I found this blog &lt;a href=&quot;https://www.winhelponline.com/blog/webcam-anniversary-update-windows-10-yuys-standard/&quot;&gt;post&lt;/a&gt; where it gives the final solution using registry. So if Solution 1 did not work for you , give it a try:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Create a Restore Point first.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Start &lt;code class=&quot;highlighter-rouge&quot;&gt;Regedit.exe&lt;/code&gt; and go to the following key:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Media Foundation\Platform
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Create a REG_DWORD value named EnableFrameServerMode and leave the data to 0.
If you’re using Windows 64-bit, make the changes here, in addition:&lt;/p&gt;

    &lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Windows Media Foundation\Platform
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
    &lt;p&gt;The above key is for 32-bit applications running on a Windows 64-bit computer.
Exit the Registry Editor.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;No other solution had worked for us. We hope that FrameServer is not used by another program so this trick will not cause any more issues.&lt;/p&gt;

&lt;p&gt;I hope it helped! Happy new year 2020!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Lenovo" /><category term="Camera" /><category term="lenovo" /><category term="thinkpad" /><category term="t470p" /><category term="camera" /><category term="issue" /><category term="problem" /><category term="not" /><category term="working" /><category term="error" /><category term="windows" /><category term="update" /><category term="driver" /><summary type="html">Issues</summary></entry><entry><title type="html">Convert Markdown to PDF using Docker, Pandoc and Asciidoctor</title><link href="https://manios.org/2020/01/08/convert-markdown-to-pdf-using-docker-pandoc-asciidoctor" rel="alternate" type="text/html" title="Convert Markdown to PDF using Docker, Pandoc and Asciidoctor" /><published>2020-01-08T10:01:00-06:00</published><updated>2020-01-08T10:01:00-06:00</updated><id>https://manios.org/2020/01/08/convert-markdown-to-pdf-using-docker-pandoc-asciidoctor</id><content type="html" xml:base="https://manios.org/2020/01/08/convert-markdown-to-pdf-using-docker-pandoc-asciidoctor">&lt;p&gt;Today we had to deliver a .pdf file to a customer containing documentation about a system. The documentation was written in &lt;a href=&quot;https://daringfireball.net/projects/markdown/syntax&quot;&gt;Markdown&lt;/a&gt; and needed to be converted to PDF. After some thoughts we did not find some straightforward way to do it, so we needed to convert Markdown to Asciidoctor using &lt;a href=&quot;https://pandoc.org/&quot;&gt;Pandoc&lt;/a&gt; first and then from Asciidoctor to PDF. In addition to that, we love Docker, so we used Docker containers to achieve that. The containers used:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hub.docker.com/r/pandoc/core&quot;&gt;pandoc/core&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://hub.docker.com/r/asciidoctor/docker-asciidoctor&quot;&gt;asciidoctor/docker-asciidoctor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We prepared quickly a small Bash script, which is the following (Listing of &lt;code class=&quot;highlighter-rouge&quot;&gt;convertMdToPdf.sh&lt;/code&gt;):&lt;/p&gt;

&lt;div class=&quot;language-ssh highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;set&lt;/span&gt; -eux

&lt;span class=&quot;k&quot;&gt;INPUT&lt;/span&gt;_MD_FILE=bob.md
&lt;span class=&quot;k&quot;&gt;OUT&lt;/span&gt;_ADOC_FILE=tmpOut.adoc 
OUT_TMP_PDF_FILE=tmpOut.pdf
&lt;span class=&quot;k&quot;&gt;OUT&lt;/span&gt;_PDF_FILE=documentation.pdf

&lt;span class=&quot;k&quot;&gt;echo&lt;/span&gt; &quot;Clear temporary files (if exist)&quot;

&lt;span class=&quot;c1&quot;&gt;# Clear any temporary files&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;rm&lt;/span&gt; -f &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_ADOC_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot; &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_PDF_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot; &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_TMP_PDF_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot; || true)

&lt;span class=&quot;c1&quot;&gt;# Convert Markdown to Asciidoctor&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;docker&lt;/span&gt; run --rm -v &quot;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;(pwd)&quot;:/data pandoc/core  -f markdown -t asciidoc -i &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;INPUT_MD_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot; -o &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_ADOC_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot;

&lt;span class=&quot;c1&quot;&gt;# Convert Asciidoctor to PDF&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;docker&lt;/span&gt; run --rm -v &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;(pwd):/documents/ asciidoctor/docker-asciidoctor asciidoctor-pdf &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_ADOC_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot;

&lt;span class=&quot;c1&quot;&gt;# Rename the output PDF to a more proper one&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;mv&lt;/span&gt; &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_TMP_PDF_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot;  &quot;&lt;span class=&quot;err&quot;&gt;${&lt;/span&gt;OUT_PDF_FILE&lt;span class=&quot;err&quot;&gt;}&lt;/span&gt;&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is it! Very simple and straightforward! I hope this article helps you and you will not devote much time to do the same. Have a nice day from a stormy Greece!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="Markdown" /><category term="PDF" /><category term="File" /><category term="Conversion" /><category term="markdown" /><category term="md" /><category term="pdf" /><category term="docker" /><category term="asciidoctor" /><category term="convert" /><category term="file" /><category term="container" /><summary type="html">Today we had to deliver a .pdf file to a customer containing documentation about a system. The documentation was written in Markdown and needed to be converted to PDF. After some thoughts we did not find some straightforward way to do it, so we needed to convert Markdown to Asciidoctor using Pandoc first and then from Asciidoctor to PDF. In addition to that, we love Docker, so we used Docker containers to achieve that. The containers used:</summary></entry><entry><title type="html">Force Maven to execute offline with local repository dependencies in a machine without Internet connection</title><link href="https://manios.org/2019/08/21/force-maven-offline-execute-goal-dependencies" rel="alternate" type="text/html" title="Force Maven to execute offline with local repository dependencies in a machine without Internet connection" /><published>2019-08-21T12:57:53-05:00</published><updated>2019-08-21T12:57:53-05:00</updated><id>https://manios.org/2019/08/21/force-maven-offline-execute-goal-dependencies</id><content type="html" xml:base="https://manios.org/2019/08/21/force-maven-offline-execute-goal-dependencies">&lt;p&gt;Debugging an application which runs on a remote Virtual Machine can prove to be very hard, especially if your client has “exceptional” conditions due to security, company or any other psycological measures/policies. For example, your VM can be a Windows machine (yes, Windows servers are an exception themselves and impose many issues and difficulties), it may have no internet connection or accept no traffic other than http and RDP. Typically we as developers are called to confront such installations and make them work. As a paralellism, we are asked to fix a vehicle engine through the exhaust pipe without having access to the hood!&lt;/p&gt;

&lt;p&gt;If you are not bored to death yet, you may proceed!&lt;/p&gt;

&lt;h2 id=&quot;the-problem&quot;&gt;The problem&lt;/h2&gt;

&lt;p&gt;A few days ago we had to remotely debug a Java Enterprise application inside a VM. The interesting fact was that everything had to be offline. Thus IDE installation, Maven installation and compile a Java project using Maven with no internet connection. Everything had to go fully offline. Really. Trully. Nothing special! (for a non technical person) At first we thought that it would suffice if we just copy the local maven repository from a development machine to the VM. Unfortunately that was not the case and it was not as simple as it looked like.&lt;/p&gt;

&lt;p&gt;After investing 3 hours in searching and numerous trial and error attempts we managed to compile the application using Maven. The steps described are performed in 2 phases:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Preparation steps performed in a development machine with internet connection.&lt;/li&gt;
  &lt;li&gt;Steps performed inside the VM with no internet connection (trully offline).&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;inside-your-development-machine&quot;&gt;Inside your development machine&lt;/h2&gt;

&lt;h3 id=&quot;step-1-create-a-new-local-repository&quot;&gt;Step 1: Create a new local repository&lt;/h3&gt;

&lt;p&gt;This new local repository will be used only for the dependencies required by your application to be compiled in offline mode. It is unnecessary to copy your everyday repository with all other redundant dependencies which maybe numerous and great in size.&lt;/p&gt;

&lt;p&gt;In order to create a new local repository, navigate to your Maven &lt;code class=&quot;highlighter-rouge&quot;&gt;settings.xml&lt;/code&gt; file. By default you can find it in:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;C:\Users\&amp;lt;your-username&amp;gt;\.m2\settings.xml&lt;/code&gt;: in Windows machines&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/home/&amp;lt;your-username&amp;gt;/.m2/settings.xml&lt;/code&gt;: in Linux or *nix machines&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Edit the line:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Point to a new empty directory --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;localRepository&amp;gt;&lt;/span&gt;C:/apps/m2repo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/localRepository&amp;gt;&lt;/span&gt;--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step-2-run-maven-to-download-dependencies-for-offline-usage&quot;&gt;Step 2: Run Maven to download dependencies for offline usage&lt;/h3&gt;

&lt;p&gt;In order to to download dependencies for offline usage, inside our project we execute the following:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mvn dependency:go-offline
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Helpful link: &lt;a href=&quot;https://stackoverflow.com/questions/8851424/is-there-a-maven-command-line-option-for-offline-mode&quot;&gt;StackOverflow #8851424&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;step-3-run-your-usual-maven-goals&quot;&gt;Step 3: Run your usual Maven goals&lt;/h3&gt;

&lt;p&gt;You also have to run your usual Maven goals which you eventually you are going to execute again in the offline VM, like &lt;code class=&quot;highlighter-rouge&quot;&gt;clean&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;package&lt;/code&gt;. The reason for that is that Maven did not download the .jars needed for these goals when you run &lt;code class=&quot;highlighter-rouge&quot;&gt;mvn dependency:go-offline&lt;/code&gt;. In our case we run:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mvn clean &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;mvn clean &lt;span class=&quot;nb&quot;&gt;install
&lt;/span&gt;mvn clean package
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You will notice that Maven downloads some extra .jars needed to execute its goals:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mvn clean &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Scanning &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;projects...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Building jetsprinkler 2.5.0-SNAPSHOT
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;------------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-clean-plugin:2.5:clean &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-clean&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-resources-plugin:2.6:resources &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-resources&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Using &lt;span class=&quot;s1&quot;&gt;'UTF-8'&lt;/span&gt; encoding to copy filtered resources.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Copying 11 resources
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-compiler-plugin:2.3.2:compile &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-compile&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Compiling 64 &lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;files to C:&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;avaprojects&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;etsprinkler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;arget&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;lasses
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-resources-plugin:2.6:testResources &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-testResources&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Using &lt;span class=&quot;s1&quot;&gt;'UTF-8'&lt;/span&gt; encoding to copy filtered resources.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Copying 8 resources
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-compiler-plugin:2.3.2:testCompile &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-testCompile&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Compiling 15 &lt;span class=&quot;nb&quot;&gt;source &lt;/span&gt;files to C:&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;avaprojects&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;etsprinkler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;arget&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;est-classes
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt; maven-surefire-plugin:2.12.4:test &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;default-test&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; @ jetsprinkler &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] Surefire report directory: C:&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;avaprojects&lt;span class=&quot;se&quot;&gt;\j&lt;/span&gt;etsprinkler&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;arget&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;urefire-reports
Downloading from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-junit4/2.12.4/surefire-junit4-2.12.4.pom
Downloaded from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-junit4/2.12.4/surefire-junit4-2.12.4.pom &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.4 kB at 4.2 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Downloading from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-providers/2.12.4/surefire-providers-2.12.4.pom
Downloaded from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-providers/2.12.4/surefire-providers-2.12.4.pom &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.3 kB at 18 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Downloading from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-junit4/2.12.4/surefire-junit4-2.12.4.jar
Downloaded from public: https://nexus.manios.org/nexus/repository/public/org/apache/maven/surefire/surefire-junit4/2.12.4/surefire-junit4-2.12.4.jar &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;37 kB at 187 kB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------&lt;/span&gt;
 T E S T S
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step-4-copy-your-local-repository-to-the-remote-vm&quot;&gt;Step 4: Copy your local repository to the remote VM&lt;/h3&gt;

&lt;p&gt;We have to copy the contents of our new local repository (in our case &lt;code class=&quot;highlighter-rouge&quot;&gt;C:/apps/m2repo&lt;/code&gt;) to the remote VM with no internet connection. Place the contents of the repository in the respective repository directory.&lt;/p&gt;

&lt;h2 id=&quot;inside-the-offline-machine-with-no-internet-connection&quot;&gt;Inside the offline machine (with no internet connection)&lt;/h2&gt;

&lt;p&gt;The following steps will be run inside the target machine with no internet connection. Verify that you have cloned your source code somewhere.&lt;/p&gt;

&lt;h3 id=&quot;step-5-remove-dependency-files-that-cause-trouble-in-offline-mode&quot;&gt;Step 5: Remove dependency files that cause trouble in offline mode&lt;/h3&gt;

&lt;p&gt;When Maven resolves and downloads a dependency from the internet, it stores 2-3 extra files other than the .jars that contain the library, javadoc or the sources. For example for &lt;a href=&quot;https://mvnrepository.com/artifact/org.springframework/spring-core&quot;&gt;spring-core&lt;/a&gt;, the files inside the local repository are:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; ~/.m2/repository/org/springframework/spring-core/4.1.7.RELEASE/
total 1004
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 bobos bobos     212 Jun 17 13:16 _remote.repositories
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 bobos bobos 1008584 Jun 17 13:16 spring-core-4.1.7.RELEASE.jar
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 bobos bobos      40 Jun 17 13:16 spring-core-4.1.7.RELEASE.jar.sha1
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 bobos bobos    2490 Jun 17 13:16 spring-core-4.1.7.RELEASE.pom
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt; 1 bobos bobos      40 Jun 17 13:16 spring-core-4.1.7.RELEASE.pom.sha1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;An here is the peculiar fact:&lt;/p&gt;

&lt;p&gt;Although we configure Maven to work offline, when it detects files with the extension &lt;code class=&quot;highlighter-rouge&quot;&gt;*.repositories&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;*.sha1&lt;/code&gt;, it tries to connect to the internet! Consequently the Maven goal we run tries to download the dependency from the internet and it eventually fails after timeout (StackOverflow &lt;a href=&quot;https://stackoverflow.com/questions/33548395/how-do-i-force-maven-to-use-my-local-repository-rather-than-going-out-to-remote&quot;&gt;#33548395&lt;/a&gt;). To resolve this issue we have to recursively delete all files with the aforementioned suffixes. Hence, execute:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cd to repository directory&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/.m2/repository

&lt;span class=&quot;c&quot;&gt;# Then delete recursively all files&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# with the extension `*.repositories` or `*.sha1`&lt;/span&gt;
find &lt;span class=&quot;nt&quot;&gt;-iname&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;*.repositories&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
find &lt;span class=&quot;nt&quot;&gt;-iname&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;*.sha1&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This issue might also be resolved by tweaking the &lt;a href=&quot;https://maven.apache.org/ref/3.3.3/maven-settings/settings.html#class_snapshots&quot;&gt;updatePolicy&lt;/a&gt; in Maven as mentioned in StackOverflow &lt;a href=&quot;https://stackoverflow.com/questions/33548395/how-do-i-force-maven-to-use-my-local-repository-rather-than-going-out-to-remote&quot;&gt;#33548395&lt;/a&gt; but unfortunately we did not have the time to test it.&lt;/p&gt;

&lt;h3 id=&quot;step-6-optional-fix-parent-pom-references&quot;&gt;Step 6 (optional): Fix parent pom references&lt;/h3&gt;

&lt;p&gt;In our case, the project had a parent pom:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;parent&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.airplaneman&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;super-pom&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.1.4&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/parent&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which could not be downloaded from an external Maven repository. We had the files offline, however this configuration could not work. To make it work we had to add the &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;relativePath&amp;gt;&lt;/code&gt; to the pom file. This is trully a relative path to the project.&lt;/p&gt;

&lt;p&gt;Hence our project was placed in:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;C:/projects/jetsprinkler&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and the parent pom was located in&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;C:/Users/cmanios/.m2/repository/com/airplanman/super-pom/1.1.4/super-pom-1.1.4.pom&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;To reference the parent pom in a relative way, we resulted in the following configuration:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;parent&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.airplaneman&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;super-pom&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.1.4&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;relativePath&amp;gt;&lt;/span&gt;../../Users/cmanios/.m2/repository/com/airplanman/super-pom/1.1.4/super-pom-1.1.4.pom&lt;span class=&quot;nt&quot;&gt;&amp;lt;/relativePath&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/parent&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For more info regarding parent pom refer to:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;DZone: &lt;a href=&quot;https://dzone.com/articles/mavens-non-resolvable-parent&quot;&gt;Maven Non Resolvable parent pom&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;StackOverflow &lt;a href=&quot;https://stackoverflow.com/questions/7612309/maven-non-resolvable-parent-pom&quot;&gt;#7612309 Non Resolvable parent pom&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.google.com/search?client=firefox-b-d&amp;amp;q=offline+non+resolvable+parent+pom&quot;&gt;Google search: Offline Non Resolvable parent pom&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;step-7-configure-maven-to-work-offline&quot;&gt;Step 7: Configure Maven to work offline&lt;/h3&gt;

&lt;p&gt;Edit your Maven &lt;code class=&quot;highlighter-rouge&quot;&gt;settings.xml&lt;/code&gt; file in the following lines:&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- (Optional) Set the path to your local repository --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;localRepository&amp;gt;&lt;/span&gt;/path/to/local/repo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/localRepository&amp;gt;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- Run Maven in Offline mode --&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;offline&amp;gt;&lt;/span&gt;true&lt;span class=&quot;nt&quot;&gt;&amp;lt;/offline&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;step-8-execute-your-goals-with--o-and--nsu-flag&quot;&gt;Step 8: Execute your goals with -o and -nsu flag&lt;/h3&gt;

&lt;p&gt;It is useful that you run your goals with &lt;code class=&quot;highlighter-rouge&quot;&gt;-o&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;-nsu&lt;/code&gt; flags. According to &lt;a href=&quot;https://maven.apache.org/ref/3.1.0/maven-embedder/cli.html&quot;&gt;documentation&lt;/a&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-o&lt;/code&gt;: Work offline&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt; -nsu,--no-snapshot-updates&lt;/code&gt;: Suppress SNAPSHOT updates&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Thus your goal will look like this:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mvn &lt;span class=&quot;nt&quot;&gt;-nsu&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; clean &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;troubleshooting&quot;&gt;Troubleshooting&lt;/h2&gt;

&lt;h3 id=&quot;cannot-access-central-httpsrepomavenapacheorgmaven2-in-offline-mode-and-the-artifact-orgapachemavenplugins&quot;&gt;Cannot access central (https://repo.maven.apache.org/maven2) in offline mode and the artifact org.apache.maven.plugins…&lt;/h3&gt;

&lt;p&gt;You may step on this error:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[WARNING] The POM for org.apache.maven.plugins:maven-resources-plugin:jar:2.6 is missing, no dependency information available
[INFO] ---------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------
[ERROR] Plugin org.apache.maven.plugins:maven-resources-plugin:2.6 or one of its dependencies could not be resolved: Cannot access central (https://repo.maven.apache.org/maven2) in offline mode and the artifact org.apache.maven.plugins:maven-resources-plugin:jar:2.6 has not been downloaded from it before. -&amp;gt; [Help 1]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;if you omit &lt;strong&gt;Step 3&lt;/strong&gt;. Maven tries to download it’s plugins to run the goals but they do not exist.&lt;/p&gt;

&lt;h3 id=&quot;non-resolvable-parent-pom--and-parentrelativepath-points-at-no-local-pom&quot;&gt;Non-resolvable parent POM […] and ‘parent.relativePath’ points at no local POM&lt;/h3&gt;

&lt;p&gt;If you see an error similar to the following:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-log&quot;&gt;[INFO] Scanning for projects...
[DEBUG] Verifying availability of C:\Users\admin_manios\.m2\repository\com\airplanman\super-pom\1.1.4\super-pom-1.1.4.pom from [central (https://repo.maven.apache.org/maven2, default, releases)]
[ERROR] [ERROR] Some problems were encountered while processing the POMs:
[FATAL] Non-resolvable parent POM for airplanman.airsprinkler:jetengine:2.5.0-SNAPSHOT: Cannot access central (https://repo.maven.apache.org/maven2) in offline mode and the artifact com.airplaneman:super-pom:pom:1.1.4 has not been downloaded from it before. and 'parent.relativePath' points at no local POM @ line 10, column 10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;then it means that either you did not copy the parent pom in your local repository for offline usage, or you did not set correctly the &lt;code class=&quot;highlighter-rouge&quot;&gt;relativePath&lt;/code&gt;. Please refer to &lt;strong&gt;Step 6&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;maven-attempts-to-download-artifacts-although-we-have-configure-it-for-offline-mode&quot;&gt;Maven attempts to download artifacts although we have configure it for offline mode&lt;/h3&gt;

&lt;p&gt;Either you have not downloaded all your dependencies as described in &lt;strong&gt;Step 2&lt;/strong&gt; or you have not deleted the files described in &lt;strong&gt;Step 5.&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I hope this article helps you and you will not waste so much time to do the same. Have a nice day and a wonderful and fruitful life!&lt;/p&gt;</content><author><name>cmanios</name></author><category term="MongoDB" /><category term="Database" /><category term="NoSQL" /><category term="maven" /><category term="offline" /><category term="goal" /><category term="dependencies" /><category term="without" /><category term="internet" /><category term="connection" /><category term="parent" /><category term="pom" /><category term="non" /><category term="resolvable" /><summary type="html">Debugging an application which runs on a remote Virtual Machine can prove to be very hard, especially if your client has “exceptional” conditions due to security, company or any other psycological measures/policies. For example, your VM can be a Windows machine (yes, Windows servers are an exception themselves and impose many issues and difficulties), it may have no internet connection or accept no traffic other than http and RDP. Typically we as developers are called to confront such installations and make them work. As a paralellism, we are asked to fix a vehicle engine through the exhaust pipe without having access to the hood!</summary></entry></feed>